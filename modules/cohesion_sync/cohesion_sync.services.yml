services:
  # Group of entities (website settings)
  plugin.manager.cohesion_sync.processor:
    class: Drupal\cohesion_sync\SyncPluginManager
    parent: default_plugin_manager

  cohesion_sync.packager:
    class: Drupal\cohesion_sync\PackagerManager
    arguments: ['@entity.repository', '@entity_type.manager', '@plugin.manager.cohesion_sync.processor', '@cohesion_usage.update_manager', '@file_system', '@logger.factory', '@config.storage']

  cohesion_sync.drush_helpers:
    class: \Drupal\cohesion_sync\Drush\CommandHelpers
    arguments: ['@entity_type.manager', '@config.factory', '@cohesion_sync.packager', '@entity.repository', '@state', '@file_system', '@uuid']

  cohesion_sync.config_import_subscriber.decorator:
    class: Drupal\cohesion_sync\EventSubscriber\Import\SyncConfigImportSubscriber
    arguments: ['@theme_handler', '@extension.list.module']
    decorates: config_import_subscriber
    decoration_priority: 5
    tags:
      - { name: event_subscriber }

  cohesion_sync.config_import_subscriber.component_config_validation:
    class: Drupal\cohesion_sync\EventSubscriber\Import\ComponentConfigImportSubscriber
    tags:
      - { name: event_subscriber }
    arguments: ['@entity_type.manager', '@cohesion_usage.update_manager', '@database', '@string_translation']

  cohesion_sync.config_import_subscriber.style_guide_config_validation:
    class: Drupal\cohesion_sync\EventSubscriber\Import\StyleGuideConfigImportSubscriber
    tags:
      - { name: event_subscriber }
    arguments: ['@entity_type.manager', '@cohesion_usage.update_manager', '@database', '@string_translation']

  cohesion_sync.full_package_storage:
    class: Drupal\cohesion_sync\Config\CohesionFullPackageStorage
    arguments: [ '@config.storage', '@config.manager', '@plugin.manager.usage.processor']

  cohesion_sync.package_import.sync_files_subscriber:
    class: Drupal\cohesion_sync\EventSubscriber\Import\SiteStudioSyncFilesSubscriber
    tags:
      - { name: event_subscriber }
    arguments: ['@entity_type.manager', '@file_system', '@logger.factory']
